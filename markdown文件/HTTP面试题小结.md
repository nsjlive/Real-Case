##### HTTP面试题小结

##### 什么是Http协议

客户端和服务器端之间数据传输的格式规范，格式简称为“超文本传输协议”

###### HTTP协议与TCP/IP协议的关系

> HTTP的长连接和短连接本质上是TCP长连接和短连接。
>
> HTTP属于应用层协议，在传输层使用TCP协议，在网络层使用IP协议。
>
>  IP协议主要解决网络路由和寻址问题，TCP协议主要解决如何在IP层之上可靠地传递数据包，使得网络上接收端收到发送端所发出的所有包，并且顺序与发送顺序一致。TCP协议是可靠的、面向连接的。

######  Http协议有哪些特征?

> 1、支持客户/服务器模式；
> 2、简单快速；
> 3、灵活；
> 4、无连接；
> 5、无状态；

######  如何理解HTTP协议是无状态的

> HTTP协议是无状态的，指的是协议对于事务处理没有记忆能力，服务器不知道客户端是什么状态。
>
> 也就是说，打开一个服务器上的网页和上一次打开这个服务器上的网页之间没有任何联系。HTTP是一个无状态的面向连接的协议，无状态不代表HTTP不能保持TCP连接，更不能代表HTTP使用的是UDP协议（无连接）。  

######  Http协议首部字段

> a、通用首部字段（请求报文与响应报文都会使用的首部字段）
> Date：创建报文时间
> Connection：连接的管理
> Cache-Control：缓存的控制
> Transfer-Encoding：报文主体的传输编码方式
>
> b、请求首部字段（请求报文会使用的首部字段）
> Host：请求资源所在服务器
> Accept：可处理的媒体类型
> Accept-Charset：可接收的字符集
> Accept-Encoding：可接受的内容编码
> Accept-Language：可接受的自然语言
>
> c、响应首部字段（响应报文会使用的首部字段）
> Accept-Ranges：可接受的字节范围
> Location：令客户端重新定向到的URI
> Server：HTTP服务器的安装信息
>
> d、实体首部字段（请求报文与响应报文的的实体部分使用的首部字段）
> Allow：资源可支持的HTTP方法
> Content-Type：实体主类的类型
> Content-Encoding：实体主体适用的编码方式
> Content-Language：实体主体的自然语言
> Content-Length：实体主体的的字节数
> Content-Range：实体主体的位置范围，一般用于发出部分请求时使用

######  HTTP状态码，你知道哪些

> 200：请求被正常处理
> 204：请求被受理但没有资源可以返回
> 206：客户端只是请求资源的一部分，服务器只对请求的部分资源执行GET方法，相应报文中通过Content-Range指定范围的资源。
> 301：永久性重定向
> 302：临时重定向
> 303：与302状态码有相似功能，只是它希望客户端在请求一个URI的时候，能通过GET方法重定向到另一个URI上
> 304：发送附带条件的请求时，条件不满足时返回，与重定向无关
> 307：临时重定向，与302类似，只是强制要求使用POST方法
> 400：请求报文语法有误，服务器无法识别
> 401：请求需要认证
> 403：**请求的对应资源禁止被访问**
> 404：服务器无法找到对应资源
> 500：**服务器**内部错误
> 503：服务器正忙  

###### HTTP报文格式

#### 请求报文

HTTP请求报文由请求行、请求头、空行和请求内容4个部分构成。

![å¾çè¯´æ](C:\Users\n\OneDrive - std.uestc.edu.cn\秋招\面经\Real-Case\markdown文件\assets\659657122_1568216479697_34C80DB83FD510D8709597B587454325)

**请求行：**
由请求方法字段、URL字段、协议版本字段三部分构成，它们之间由空格隔开。常用的请求方法有：GET、POST、HEAD、PUT、DELETE、OPTIONS、TRACE、CONNECT。

**请求头：**
请求头由key/value对组成，每行为一对，key和value之间通过冒号(:)分割。请求头的作用主要用于通知服务端有关于客户端的请求信息。

> 典型的请求头有：
> User-Agent：生成请求的浏览器类型
> Accept：客户端可识别的响应内容类型列表；星号*用于按范围将类型分组。*/\*表示可接受全部类型，type/*表示可接受type类型的所有子类型。
> Accept-Language: 客户端可接受的自然语言
> Accept-Encoding: 客户端可接受的编码压缩格式
> Accept-Charset： 可接受的字符集
> Host: 请求的主机名，允许多个域名绑定同一IP地址
> connection：连接方式（close或keeplive）
> Cookie: 存储在客户端的扩展字段  

**空行:**
最后一个请求头之后就是空行，用于告诉服务端以下内容不再是请求头的内容了。

**请求内容:**
请求内容主要用于POST请求，与POST请求方法配套的请求头一般有Content-Type（标识请求内容的类型）和Content-Length（标识请求内容的长度）

![å¾çè¯´æ](C:\Users\n\OneDrive - std.uestc.edu.cn\秋招\面经\Real-Case\markdown文件\assets\659657122_1568215951216_EE2A7442028D34CA1831EE7A4E151C26)



**状态行：**
由HTTP协议版本、状态码、状态码描述三部分构成，它们之间由空格隔开。

> 状态码由3位数字组成，第一位标识响应的类型，常用的5大类状态码如下：
> 1xx：表示服务器已接收了客户端的请求，客户端可以继续发送请求
> 2xx：表示服务器已成功接收到请求并进行处理
> 3xx：表示服务器要求客户端重定向
> 4xx：表示客户端的请求有非法内容
> 5xx：标识服务器未能正常处理客户端的请求而出现意外错误

**响应头：**
一般情况下，响应头会包含以下，甚至更多的信息。

> Location：服务器返回给客户端，用于重定向到新的位置
> Server： 包含服务器用来处理请求的软件信息及版本信息
> Vary：标识不可缓存的请求头列表
> Connection: 连接方式。

**对于请求端来讲：** close是告诉服务端，断开连接，不用等待后续的求请了。keeplive则是告诉服务端，在完成本次请求的响应后，保持连接，等待本次连接后的后续请求。
**对于响应端来讲：** close表示连接已经关闭。keeplive则表示连接保持中，可以继续处理后续请求。Keep-Alive表示如果请求端保持连接，则该请求头部信息表明期望服务端保持连接多长时间（秒），例如300秒，应该这样写Keep-Alive: 300

**空行：**
最后一个响应头之后就是空行，用于告诉请求端以下内容不再是响应头的内容了。

**响应内容：**
服务端返回给请求端的文本信息。

###### 大文件怎么分块编码传输

> 分块传输编码是超文本传输协议（HTTP）中的一种数据传输机制，允许HTTP由应用服务器发送给客户端应用（ 通常是网页浏览器）的数据可以分成多个部分。分块传输编码只在**HTTP1.1**版本中提供。
>
> 通常，HTTP应答消息中发送的数据是整个发送的，Content-Length消息头字段表示数据的长度。数据的长度很重要，因为客户端需要知道哪里是应答消息的结束，以及后续应答消息的开始。然而，使用分块传输编码，数据分解成一系列数据块，并以一个或多个块发送，这样服务器可以发送数据而不需要预先知道发送内容的总大小。通常数据块的大小是一致的。

**HTTP 1.1引入分块传输编码提供了以下几点好处：**
1、**HTTP分块传输编码允许服务器为动态生成的内容维持HTTP持久连接。** 通常，持久链接需要服务器在开始发送消息体前发送Content-Length消息头字段，但是对于动态生成的内容来说，在内容创建完之前是不可知的。

2、**分块传输编码允许服务器在最后发送消息头字段。** 对于那些头字段值在内容被生成之前无法知道的情形非常重要，例如消息的内容要使用散列进行签名，散列的结果通过HTTP消息头字段进行传输。没有分块传输编码时，服务器必须缓冲内容直到完成后计算头字段的值并在发送内容前发送这些头字段的值。[散列签名，需缓冲完成才能计算]

3、**HTTP服务器可以压缩与传输同时进行以缩短传输花费的时间。** 分块传输编码可以用来分隔压缩对象的多个部分。在这种情况下，块不是分别压缩的，而是整个负载进行压缩，压缩的输出使用本文描述的方案进行分块传输。在压缩的情形中，分块编码有利于一边进行压缩一边发送数据，而不是先完成压缩过程以得知压缩后数据的大小。[gzip压缩]

###### Http协议中有哪些请求方式?

> URI:可以分为URL,URN或同时具备locators 和names特性的一个东西。URN作用就好像一个人的名字，URL就像一个人的地址。换句话说：URN确定了东西的身份，URL提供了找到它的方式。
>
> GET:用于请求访问已经被URI(统一资源标识符)识别的资源,可以通过URL传参给服务器
>
> POST:用于传输信息给服务器,主要功能与GET方法类似,但一般推荐使用POST方式
>
> PUT:传输文件,报文主体中包含文件内容,保存到对应URI位置
>
> HEAD:获得报文首部,与GET方法类似,只是不返回报文主体,一般用于验证URI是否有效
>
> DELETE:删除文件,与PUT方法相反,删除对应URI位置的文件
>
> OPTIONS:查询响应URI支持的HTTP方法

###### 什么是HTTP长连接

**长连接定义：**
client方与server方先建立连接，连接建立后不断开，然后再进行报文发送和接收。这种方式下由于通讯连接一直存在。此种方式常用于P2P点对点的通信。

长连接的操作步骤是：建立连接——数据传输...（保持连接）...数据传输——关闭连接

**长连接适用场景：**
监控系统：后台硬件热插拔、LED、温度、电压发生变化；
即时通信系统：其它用户登录、发送信息；
即时报价系统：后台数据库内容发生变化；
像以上这些连接，如果每次操作都要建立连接然后再操作的话处理速度会降低。所以操作时第一次连接上以后，以后每次直接发送数据就可以了，不用再建立TCP连接。
再比如：数据库的连接用长连接，如果用短连接频繁的通信会造成socket错误，频繁的socket创建也是对资源的浪费。

###### 什么是HTTP短连接

###### Client方与server每进行一次报文收发交易时才进行通讯连接，交易完毕后立即断开连接。此方式常用于一点对多点通讯。

短连接的操作步骤是：建立连接——数据传输——关闭连接...建立连接——数据传输——关闭连接

> **短连接的适用场景：**
> 短连接多用于操作频繁，点对点的通讯，而且连接数不能太多的情况。每个TCP连接的建立都需要三次握手，每个TCP连接的断开要四次握手。
> web网站的http服务一般都用短连接。因为长连接对于服务器来说要耗费一定的资源。像web网站这么频繁的成千上万甚至上亿客户端的连接用短连接更省一些资源。
> 试想如果都用长连接，而且同时用成千上万的用户，每个用户都占有一个连接的话，可想而知服务器的压力有多大。所以并发量大，但是每个用户又不需频繁操作的情况下需要短连接。总之：长连接和短连接的选择要视需求而定。

###### Get和POST方法的区别

**1、传送方式：get通过地址栏传输，post通过报文传输。**

**2、传送长度：get参数有长度限制（受限于url长度），而post无限制**

**3、GET产生一个TCP数据包；POST产生两个TCP数据包。**



对于GET方式的请求，浏览器会把http header和data一并发送出去，服务器响应200（返回数据）

而对于POST，浏览器先发送header，服务器响应100 continue，浏览器再发送data，服务器响应200 ok（返回数据）。

因为POST需要两步，时间上消耗的要多一点，看起来GET比POST更有效。因此Yahoo团队有推荐用GET替换POST来优化网站性能。但这是一个坑！跳入需谨慎。为什么？

1. GET与POST都有自己的语义，不能随便混用。 
2. 据研究，在网络环境好的情况下，发一次包的时间和发两次包的时间差别基本可以无视。而在网络环境差的情况下，两次包的TCP在验证数据包完整性上，有非常大的优点。 
3. 并不是所有浏览器都会在POST中发送两次包，Firefox就只发送一次。 

**建议：**
1、get方式的安全性较Post方式要差些，包含机密信息的话，建议用Post数据提交方式；
2、在做数据查询时，建议用Get方式；而在做数据添加、修改或删除时，建议用Post方式；

**案例：**
一般情况下，登录的时候都是用的POST传输，涉及到密码传输，而页面查询的时候，如文章id查询文章，用get 地址栏的链接为：article.php?id=11，用post查询地址栏链接为：article.php， 不会将传输的数据展现出来。

###### Http协议实现的原理机制

(1).整个流程步骤:

![å¾çè¯´æ](C:\Users\n\OneDrive - std.uestc.edu.cn\秋招\面经\Real-Case\markdown文件\assets\659657122_1568216021243_78D7BE079F0C2406A17C52C294D40B7A)

(3).三次握手过程
(4).建立连接后，客户端发起Http请求
(5).服务器响应Http请求，客户端得到HTML代码
(6).浏览器解析HTML代码
(7).浏览器对页面进行渲染呈现给用户

###### Http怎么优化？

###### HTTP和HTTPS的基本概念

HTTP：是互联网上应用最为广泛的一种网络协议，是一个客户端和服务器端请求和应答的标准（TCP），用于从WWW服务器传输超文本到本地浏览器的传输协议，它可以使浏览器更加高效，使网络传输减少。
HTTPS：是以安全为目标的HTTP通道，简单讲是HTTP的安全版，即HTTP下加入SSL层，HTTPS的安全基础是SSL，因此加密的详细内容就需要SSL。
HTTPS协议的主要作用可以分为两种：一种是建立一个信息安全通道，来保证数据传输的安全；另一种就是确认网站的真实性。  

###### HTTP与HTTPS有什么区别？

HTTP协议传输的数据都是未加密的，也就是明文的，因此使用HTTP协议传输隐私信息非常不安全，为了保证这些隐私数据能加密传输，于是网景公司设计了SSL（Secure Sockets Layer）协议用于对HTTP协议传输的数据进行加密，从而就诞生了HTTPS。简单来说，HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全。
HTTPS和HTTP的区别主要如下：

> 1、https协议需要到ca申请证书，一般免费证书较少，因而需要一定费用。
> 2、http是超文本传输协议，信息是明文传输，https则是具有安全性的ssl加密传输协议。
> 3、http和https使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。
> 4、http的连接很简单，是无状态的；HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，比http协议安全。  

###### cookie

> 位于用户的计算机上，用来维护用户计算机中的信息，直到用户删除。比如我们在网页上登录某个软件时输入用户名及密码时如果保存为cookie，则每次我们访问的时候就不需要登录网站了。我们可以在浏览器上保存任何文本，而且我们还可以随时随地的去阻止它或者删除。我们同样也可以禁用或者编辑cookie，但是有一点需要注意不要使用cookie来存储一些隐私数据，以防隐私泄***r>  

![å¾çè¯´æ](C:\Users\n\OneDrive - std.uestc.edu.cn\秋招\面经\Real-Case\markdown文件\assets\659657122_1568216122977_CCEF4A47D1E9FA935D7E016E8EFBF68E)

###### session

session称为会话信息，位于web服务器上，主要负责访问者与网站之间的交互，当访问浏览器请求http地址时，将传递到web服务器上并与访问信息进行匹配， 当关闭网站时就表示会话已经结束，网站无法访问该信息了，所以它无法保存永久数据，我们无法访问以及禁用网站  

![å¾çè¯´æ](C:\Users\n\OneDrive - std.uestc.edu.cn\秋招\面经\Real-Case\markdown文件\assets\659657122_1568216150880_50E6422A6F263A27AD4B4E667DB688A6)

### session与cookie的区别

（1）Cookie以文本文件格式存储在浏览器中，而session存储在服务端它存储了限制数据量。它只允许4kb它没有在cookie中保存多个变量。
（2）cookie的存储限制了数据量，只允许4KB，而session是无限量的
（3）我们可以轻松访问cookie值但是我们无法轻松访问会话值，因此它更安全
（4）设置cookie时间可以使cookie过期。但是使用session-destory（），我们将会销毁会话。

总结：如果我们需要经常登录一个站点时，最好用cookie来保存信息，要不然每次登陆都特别麻烦，如果对于需要安全性高的站点以及控制数据的能力时需要用会话效果更佳，当然我们也可以结合两者，使网站按照我们的想法进行运行。
